digraph boxes_and_circles {
  node [fontname="Helvetica,Arial,sans-serif"]

  subgraph cluster_rna {
      label=<Transcriptome assembly>
  node [shape=folder]; rawRNA1; rawRNA2; mtdna;
  rawRNA1 [label=<<i>C. fleckeri</i>>]
  rawRNA2 [label=<<i>C. yamaguchii</i>>]
  mtdna [label="Cnidarian mtDNA"]
  {rank=same; mtdna; rawRNA1; rawRNA2}

  node [shape=component]; fp; bbduk; spades; tdc; busco;
  mtdna->bbduk;
  {rawRNA1,rawRNA2}->fp
  fp [label=<<b>FastP</b><br/>Trim reads>]
  bbduk->spades
  fp->bbduk
  spades [label=<<b>RNASpades</b><br/>Denovo transcriptome assembly>]
  bbduk[label=<<b>BBduk</b><br/>Filter contaminants>]
  spades->tdc
  tdc->busco
  busco[label=<<b>BUSCO</b><br/>Completeness assessment>]
  tdc[label=<<b>Transdecode</b><br/>Proteome prediction>]
  }

  subgraph cluster_db {
  decoy_db[shape=plaintext;label=<Merge and create decoy database>]
  node[shape=folder]
  {unip,ncbi,tdc}->decoy_db
  }

  subgraph cluster_pre {
  { node [shape=folder]; mgf; mzml; raw }
  { node [shape=plaintext]; pre}
  node[shape=component]
  { node[shape=tab]; denovo}
  raw->thermoparse->mgf->{csnv,sms,pepnet}->denovo
  sms[label=<<b>SMSNet</b>>]
  pepnet[label=<<b>PepNet</b>>]
  csnv[label=<<b>Casanovo</b>>]
  denovo [label=<Denovo peptides>]
  denovo->decoy_db
  thermoparse->mzml
  mzml->pre->{flcn,wiz}->mzml
  {flcn,wiz}->mgf
  {rank=same; mgf;mzml}
  pre[label=<Preprocessing>]
  }

  subgraph cluster_search {
  {decoy_db,mzml}->search
  rank = same
  search [label=<To database search engines>;shape=plaintext]
  node [shape=component]
  search->{comet,mq,idpy,msfrag,meta,tide}
  comet[label=<<b>Comet</b>>]
  idpy[label=<<b>Identipy</b>>]
  meta[label=<<b>Metamorpheus</b>>]
  mq[label=<<b>Maxquant</b>>]
  tide[label=<<b>Tide</b>>]
  msfrag[label=<<b>MSFragger</b>>]
  {comet,idpy,msfrag,mq,meta,tide}->perc
  }

  subgraph cluster_bk {
  {comet,idpy,msfrag}->bk_decoy
  bk_decoy [label=<Construct Bern and Kil decoy database>; shape=plaintext]
  bk_decoy -> two -> search
  {rank=min; two}
  two[label=<Second-pass search>; shape=plaintext]
  }
  perc [shape=cylinder;fill=red;label=<<b>Percolator</b><br/>Posterior error probability calculation>]

  subgraph cluster_quant {
  label=<Label-free Quantification>
  node [shape=component]
  perc->{empai,dlfq,flfq}
  dlfq[label=<<b>DirectLFQ</b>>]
  flfq[label=<<b>FlashLFQ</b>>]
  }

  subgraph cluster_combine {
  node [shape=component]; ursgal; intersect; api; interpro
  node [shape=tab]; rand;
  perc->{ursgal,intersect}->{conf,rand}
  { rank=same; conf; rand}
  conf [label=<Database protein matches>]
  conf -> api
  api [label=<<b>UniProt Mapping API</b><br/>GO, Panther classifications>]
  rand [label=<Unmatched, denovo and transcriptome peptides>]
  { rank=min; ursgal;intersect }
  { rank=max; api }
  rand -> interpro
  interpro [label=<<b>InterproScan</b><br/>Homology-based functional prediction>]
  }
}
